<!-- fixedTableColV4.html >>>>>>>>> -->
<script>
  async function reFixedTableCol() {
    // 阻塞等待 100ms
    const delay = (ms) => {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
    await delay(100);
    
    // remove old style
    let fixedTableColStyle = document.getElementById('fixedTableColV4Style');
    if(fixedTableColStyle) {
      fixedTableColStyle.remove();
    }
    // generate new style
    let fixedTableColStyleSheet = '<!-- generated by fixedTableColV4.html >>>>>>>>> --><style id="fixedTableColV4Style">';
    let tables = document.getElementsByTagName('table');
    for(let tableIndex = 0; tableIndex < tables.length; tableIndex++) {
      let table = tables[tableIndex];
      const className = 'table-fixed-' + (tableIndex + 1);
      table.classList.add(className);
      let tableThList = table.getElementsByTagName('th');
      let left = 0;
      for(let tableThIndex = 0; tableThIndex < tableThList.length; tableThIndex++) {
        let tableTh = tableThList[tableThIndex];
        if(!tableTh.classList || !tableTh.classList.contains('fixed')) {
          continue;
        }
        fixedTableColStyleSheet += `
          table.${className} thead th.fixed:nth-child(${tableThIndex + 1}),
          table.${className} tbody td.fixed:nth-child(${tableThIndex + 1}) {
            position: sticky !important;
            position: -webkit-sticky !important;
            left: ${left - 1}px !important;
            z-index: 10!important;
            background: white;
            border-right: thin solid rgba(0, 0, 0, .06);
          }

          /* 伪元素模拟边框，并提高 z-index */
          table.${className} thead th.fixed:nth-child(${tableThIndex + 1})::after,
          table.${className} tbody td.fixed:nth-child(${tableThIndex + 1})::after {
            content: "";
            position: absolute;
            right: -1px;
            top: 0;
            bottom: 0;
            width: 1px; /* 控制边框宽度 */
            background-color: #F0F0F0 !important; /* 设定边框颜色 */
            z-index: 10; /* 让边框在最上层 */
          }
          table.${className} thead th.fixed:nth-child(${tableThIndex + 1})::after,
          table.${className} tbody td.fixed:nth-child(${tableThIndex + 1})::after {
            content: "";
            position: absolute;
            right: -1px;
            top: 0;
            bottom: 0;
            width: 1px; /* 控制边框宽度 */
            background-color: #F0F0F0 !important; /* 设定边框颜色 */
            z-index: 10; /* 让边框在最上层 */
          }
          table.${className} thead th.fixed:nth-last-child(1)::after,
          table.${className} tbody td.fixed:nth-last-child(1)::after {
            right: unset;
            left: -1px;
          }
        `;
        left += tableTh.offsetWidth;
      }
    }
    fixedTableColStyleSheet += '</style><!-- <<<<<<<< generated by fixedTableColV4.html  -->';
    document.body.insertAdjacentHTML('beforeend', fixedTableColStyleSheet);
  }
  onload = function() {
    reFixedTableCol();
  }
</script>
<!-- <<<<<<<<<< fixedTableColV4.html -->
